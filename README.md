
# Yeast Mitochondria Inheritance Simulator

This repository contains the data, source code, and resources related to the research paper titled, "Biased Placement of Mitochondria Fission Facilitates Asymmetric Inheritance of Protein Aggregates during Yeast Cell Division."

This repository contains the companion files necessary for running simulations of yeast mitochondrial dynamics and the analytical libraries necessary for examining mitochondrial inheritance.

# Abstract

Mitochondria are essential and dynamic eukaryotic organelles that must be inherited during cell division. In yeast, mitochondria are inherited asymmetrically based on quality which is thought to be vital for maintaining a rejuvenated cell population; however, the mechanisms underlying mitochondrial remodeling and segregation during this process are not understood. We used high spatiotemporal imaging to quantify the key aspects of mitochondrial dynamics, including motility, fission, and fusion characteristics, upon aggregation of misfolded proteins in the mitochondrial matrix. Using these measured parameters, we developed an agent-based stochastic model of dynamics of mitochondrial inheritance. Our model predicts that biased mitochondrial fission near the protein aggregates facilitates the clustering of protein aggregates in the mitochondrial matrix, and this process underlies asymmetric mitochondria inheritance. These predictions are supported by live-cell imaging experiments where mitochondrial fission was perturbed. Our findings therefore uncover an unexpected role of mitochondrial dynamics in asymmetric mitochondrial inheritance. 


# Table of Contents
1. [Prerequisites](#prerequisites)
2. [Directory Structure](#directory-structure)
2. [Dataset](#dataset)
3. [Usage](#usage)
4. [License](#license)
5. [Citation](#citation)

# Prerequisites

To run the code in this repository, you will need to have Python installed on your machine. The code has been tested with Python 3.7 and 3.8, but it should work with other versions as well.

You will also need to have pip installed. Pip is a package manager for Python and is included by default with Python 3.4 and later.

All the necessary Python packages that you need to install are listed in the `requirements.txt` file in this repository. You can install them using pip with the following command:

```bash
pip install -r requirements.txt
```

If you're planning on using a virtual environment (recommended), you should create and activate the environment first, before installing the requirements. Here's how you can do it:
```bash
python -m venv env
source env/bin/activate
pip install -r requirements.txt

```

Programs in this repository have been developed and tested on Ubuntu 22.04.
# Directory Structure
* [config_files](config_files) -> contains serialized configuration files
* [configs](configs) -> contains configuration libraries
* [experiments](experiments) -> contains sample experimental data
* [lib](lib) ->  contains simulation libraries 
* [tests](tests) -> contains simulation testing scripts
* [utils](utils) -> contains miscellaneous utilities

# Datasets
Sample data generated from the program is stored in the directory ```experiments```. By default, each simulation contains two separate files, one with a suffix "*PRE.pickle" and another with suffix "*POST.pickle".  These files correspond to the simulation state captured at the t=1800 transition time mark and at the end of the simulation, respectively.  The data in the "*POST.pickle" file contains information that the "*PRE.pickle" has.

Data files generated by the program are named in the following format: 
```
[DATETIME]_[EXPERIMENT_NAME]_[N_DUMP_CLUSTERS]_[DIFFUSIVE_SETTINGS]_[FISSION_FUSION_SETTINGS]_[BIASED_FISSION_SETTINGS]_s[TRIAL_NUMBER]_[PRE/POST].pickle
```
where:
* DATETIME -> Timestamp simulation started at
* EXPERIMENT_NAME -> string to describe experiment
* N_DUMP_CLUSTERS -> Number of DUMP clusters seeded at t=1800s
* DIFFUSIVE_SETTINGS -> name of diffusive settings used for simulation (wt or dump)
* FISSION_FUSION_SETTINGS -> name of fission/fusion settings used for simulation (wt or dump)
* BIASED_FISSION_SETTINGS -> percent biased fission implemented in simulation (00-100)
* TRIAL_NUMBER -> simulation trial number
* PRE/POST -> simulation state identifier, as previously described.

# Usage
## Configurations
Configuration files are stored in the directory [config_files](config_files) as serialized pickle files.  Each file contains a dictionary encoding the slope and intercept of a linear model, that is fed into its relevant class object located in [configs](configs).
## Testing
Testing scripts are contained the directory [tests](tests).  Tests test library functions located in [lib](lib) that are used to run the simulation, and [configs](configs) scripts that provide visual feedback on whether simulation configuration settings are correct.

To run tests, run the following command:
```bash
bash run_tests.sh
```

To test view the simulation, run the following command:
```bash
python -m tests.test_view_simulation
```
or 
```bash
bash run.sh
```

To test run the simulation silently or without visualization, the code in the file [test_simulation_handler.py](tests/test_simulation_handler.py) can be modified to test it.  To run the code, run the following command:
```python
python -m tests.test_simulation_handler
```

The code in [test_view_simulation.py](tests/test_view_simulation.py) or [test_simulation_handler.py](tests/test_simulation_handler.py) is used to access the simulation and run it for testing, and does not contain the setup for how it was used for the publication.  The "Simulation" class can be modified to change different simulation time-schedules and proceedures, as described in the next section.

## Running the simulation

The main simulation scripts used for running the simulation are as follows:

* [simulation_convergence.py](simulation_convergence.py) -> Used for evaluating when the simulation converges in number of mitochondria networks under WT settings for all parameters
* [single_component_sensitivity_analysis.py](single_component_sensitivity_analysis.py) -> Used for evaluating the individual contribution of diffusive motion, fission/fusion probabilities, and biased fission on mitochondria organization.
* [percent_biasedFission_testing.py](percent_biasedFission_testing.py) -> Additional script that tests contribution of varying percentage of fissions that are biased, while fixing diffusive motion, fission/fusion probabilities to DUMP settings.

Execution of the following scripts will result in multiple simulations being run at once; the number of simulations being run depends on the number of threads on your machine. 
```python
python -O simulation_convergence.py sample_experiments/
python -O single_component_sensitivity_analysis.py sample_experiments/
python -O percent_biasedFission_testing.py sample_experiments/
```

Note each command ends with "```sample_experiments/```." This is simply defining where the pickle files will be saved to.

Alternatively, the simulation can be run on a computing cluster, such as [Rockfish](https://www.arch.jhu.edu/user-guide/) using:
```bash
sbatch SLURM_SIM_DRIVER.sh
```

All simulation states will be stored as pickle serialized files at the end of each run.  
## Analysing simulation output
Given a directory containing pickle files ("PRE" and "POST") files, the analytics library traverses the whole experimental directory and queries a function to each of the simulations within.

The main analysis library is located in [analytics.py](lib/analytics.py), with sample scripts listed below:
* [analyze_endState_inheritance.py](analyze_endState_inheritance.py) -> Examines the inheritance of DUMPs at the end of a given simulation file.
* [analyze_everything.py](analyze_everything.py) -> Runs all of the analysis functions located in [analytics.py](lib/analytics.py)


Both of the commands above require a directory containing experimental pickle files and can be run as follows:
```python 
python analyze_endState_inheritance.py sample_experiments/
python analyze_everything.py sample_experiments/
```

NOTE: ```analyze_everything.py``` runs for a very long time since it runs multiple analyses; depending on the number of experimental trials run this script can take a while.

All analyses output a "*.csv" file for use in figure production.
## Playback and Rendering
To visualize what is happening in a recorded simulation, functions are included in the library [playback.py](lib/playback.py).

Example playbacks for individual simulation recordings can be run as follows:
```python 
python -m utils.draw_targetedFission_frames.py "sample_experiments/20230611023341875789_clusterTestPBC2hr_nA06_dumpDA_dumpFFI_020targFis_s186_POST.pickle"
```
The above script draws only frames where there has been a clustering event of DUMPs within the simulation.

To render out every frame in the example simulation provided above (or any other desired simulation pickle), the following command can be used:
```python 
python -m utils.draw_all_sim_frames.py "sample_experiments/20230611023341875789_clusterTestPBC2hr_nA06_dumpDA_dumpFFI_020targFis_s186_POST.pickle"
```
This command will render out every single frame as a ".png" in this  directory.


# License
This project is licensed under the [MIT License](https://opensource.org/license/mit/).

# Citation

This research paper has been submitted but not yet been published. Therefore, we currently do not have a formal citation for you to use. Once the paper is published, we will update this section with the official citation details. 
